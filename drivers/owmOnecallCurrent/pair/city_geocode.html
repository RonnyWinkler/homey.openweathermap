<script type="application/javascript">

    Homey.setTitle(Homey.__("pair.oneCallAPI.title"));

    Homey.emit("getSettings").then(function (settings) {
        if (settings){
            document.getElementById('apiKey').value = settings.APIKey; 
            document.getElementById('apiVersion').value = settings.APIVersion; 
            document.getElementById('city').value = settings.GEOlocationCity; 
            document.getElementById('interval').value = settings.pollingInterval; 
        }
    });

    function settingsChanged(){
        let value = {
            "APIKey": document.getElementById('apiKey').value,
            "APIVersion": document.getElementById('apiVersion').value,
            "GEOlocationCity": document.getElementById('city').value,
            "pollingInterval": parseInt(document.getElementById('interval').value)
        };
        Homey.emit("settingsChanged", value).then(function (result) {
            //document.getElementById('found_nr').value = result; 
        });
    }
  </script>

<div id="OWMsetup" class="tabcontent">
    <fieldset>
        <div class="api">
            <label for="apiKey"><span data-i18n="pair.oneCallAPI.apiKey"></span></label>
            <label for="apiKey"><span data-i18n="pair.oneCallAPI.apiKey2"></span></label>
            <input id="apiKey" type="text" value="" oninput="settingsChanged()"/>
            <label for="apiVersion"><span data-i18n="pair.oneCallAPI.apiVersion"></span></label>
            <br>
            <select id="apiVersion" name="apiVersion" oninput="settingsChanged()">
                <option value="2.5" selected>OneCall 2.5</option>
                <option value="3.0">OneCall 3.0</option>
            </select>
        </div>
    </fieldset>

    <fieldset>
        <div class="options">
            <label for="city"><span data-i18n="pair.oneCallAPI.city"></span></label>
            <label for="city"><span data-i18n="pair.oneCallAPI.autolocation"></span></label>
            <input id="city" type="text" value="" oninput="settingsChanged()"/>
            <label for="interval"><span data-i18n="pair.oneCallAPI.updateInterval"></span></label>
            <input id="interval" type="number" value="5" oninput="settingsChanged()"/>
        </div>
    </fieldset>
</div>